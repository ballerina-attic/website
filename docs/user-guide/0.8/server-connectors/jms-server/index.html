<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-92163714-1', 'auto');
  ga('send', 'pageview');

</script>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KW2LLTW');</script>
<!-- End Google Tag Manager -->

  
  
  
  <meta name="author" content="WSO2, Inc.">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>JMS Server Connector - Ballerina Documentation</title>
<!--  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>-->

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
   <link rel="stylesheet" href="../../css/ballerina.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "JMS Server Connector";
    var mkdocs_page_input_path = "server-connectors/jms-server.md";
    var mkdocs_page_url = "/server-connectors/jms-server/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
  
  
  
  <!--TOC-->



<!--TOC END-->
  
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="http://ballerinalang.org" class="cBallerinaLogo"><img src="../../img/ballerina-logo.svg"/></a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
<!--            <li><a href="../..">Documentation Home</li>-->
          
            <li>

  <li class="cMainLink"><span>Get Started</span>
    <ul class="subnav">
        
            


    <li class="toctree-l1 ">
        <a class="" href="../..">Welcome</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../../quick-tour/">Quick Tour</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../../tutorials/first-program/">Write your First Program</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../../key-concepts/">Key Concepts</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../../tools/">Tools</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../../samples/">Samples</a>
        
    </li>


        
    </ul>
      </li>

<li>
          
            <li>

  <li class="cMainLink"><span>Language Reference</span>
    <ul class="subnav">
        
            


    <li class="toctree-l1 ">
        <a class="" href="../../lang-ref/lang-overview/">Overview</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../../lang-ref/packaging/">Packaging and Running Programs</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../../lang-ref/services/">Services</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../../lang-ref/resources/">Resources</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../../lang-ref/functions/">Functions</a>
        
    </li>


        
            

  <li class="cMainLink"><span>Connectors</span>
    <ul class="subnav">
        
            


    <li class="toctree-l1 ">
        <a class="" href="../../lang-ref/connectors/">Working with Connectors</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../file-server/">File Server Connector</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../http2-server/">HTTP/2 Server Connector</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../jms-client/">JMS Client Connector</a>
        
    </li>


        
            


    <li class="toctree-l1 current">
        <a class="current" href="./">JMS Server Connector</a>
        
            <ul>
                <li><a href="../..">Home</a></li>
            
                <li class="toctree-l3"><a href="#jms-server-connector">JMS Server Connector</a></li>
                
                 <li><a class="toctree-l4" href="#how-to-write-a-jms-service">How to write a JMS service</a></li>
                
                 <li><a class="toctree-l4" href="#ballerina-native-functions">Ballerina Native Functions</a></li>
                
            
            </ul>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../websocket-server/">WebSocket Server Connector</a>
        
    </li>


        
    </ul>
      </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../../lang-ref/actions/">Actions</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../../lang-ref/workers/">Workers</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../../lang-ref/types-variables/">Types and Variables</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../../lang-ref/statements/">Statements</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../../lang-ref/exceptions/">Exception Handling</a>
        
    </li>


        
    </ul>
      </li>

<li>
          
            <li>

  <li class="cMainLink"><span>Additional Reference</span>
    <ul class="subnav">
        
            


    <li class="toctree-l1 ">
        <a class="" href="../../native-functions/">API Documentation</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../../spec/">Language Specification</a>
        
    </li>


        
            


    <li class="toctree-l1 ">
        <a class="" href="../../architecture/">Architecture Design Documents</a>
        
    </li>


        
    </ul>
      </li>

<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Ballerina Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Language Reference &raquo;</li>
        
      
        
          <li>Connectors &raquo;</li>
        
      
    
    <li>JMS Server Connector</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/ballerinalang/ballerina/edit/master/docs/server-connectors/jms-server.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="jms-server-connector">JMS Server Connector</h1>
<p>The JMS Server connector can be used to listen to a topic/queue in a JNDI-based JMS provider. Following is a high-level view on how the JMS Server connector works:</p>
<p><img alt="JMS_Server_Connector" src="../../images/jms_server_connector.png" /></p>
<h2 id="how-to-write-a-jms-service">How to write a JMS service</h2>
<h3 id="step-1-create-the-service">Step 1: Create the service</h3>
<p>Create a service with unique name.</p>
<p>Example: </p>
<pre><code>service jmsService {
}
</code></pre>

<h3 id="step-2-specify-the-connection-details">Step 2: Specify the connection details</h3>
<p>Add a service-level annotation named “jms:JMSSource”, and add the key-value pairs of these two mandatory properties to specify the JMS connection details.
The following table describes each key that can be used with the JMS service.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Description</th>
<th>Expected Values</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>factoryInitial</td>
<td>The JNDI initial context factory class. The class must implement the java.naming.spi.InitialContextFactory interface.</td>
<td>A valid class name depending on the JMS provider</td>
<td>-</td>
</tr>
<tr>
<td>providerUrl</td>
<td>The URL/ file path of the JNDI provider</td>
<td>A valid URL/ path for the JNDI provider</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>Example: </p>
<pre><code>import ballerina.net.jms;

@jms:JMSSource {
factoryInitial : &quot;org.wso2.andes.jndi.PropertiesFileInitialContextFactory&quot;,
providerUrl : &quot;/Users/Akalanka/test/jndi.properties&quot;}
</code></pre>

<p>The following set of parameters are optional and can be provided to the JMS provider along with any other vendor specific properties by adding an annotation named "jms:ConnectionProperty"</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Description</th>
<th>Required</th>
<th>Expected Values</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>connectionFactoryType</td>
<td>The type of the connection factory</td>
<td>no</td>
<td>queue, topic</td>
<td>queue</td>
</tr>
<tr>
<td>connectionFactoryJNDIName</td>
<td>The JNDI name of the connection factory</td>
<td>Yes</td>
<td>A valid JNDI name of the connection factory.</td>
<td>-</td>
</tr>
<tr>
<td>destination</td>
<td>The JNDI name of the destination</td>
<td>no</td>
<td>A valid JNDI name of the destination</td>
<td>service name</td>
</tr>
<tr>
<td>sessionAcknowledgement</td>
<td>The JMS session acknowledgment mode</td>
<td>no</td>
<td>AUTO_ACKNOWLEDGE, CLIENT_ACKNOWLEDGE, DUPS_OK_ACKNOWLEDGE, SESSION_TRANSACTED</td>
<td>AUTO_ACKNOWLEDGE</td>
</tr>
<tr>
<td>connectionUsername</td>
<td>The JMS connection username</td>
<td>no</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>connectionPassword</td>
<td>The JMS connection password</td>
<td>no</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>subscriptionDurable</td>
<td>Whether subscription is durable</td>
<td>no</td>
<td>true/false</td>
<td>false (subscription is not durable)</td>
</tr>
<tr>
<td>durableSubscriberClientID</td>
<td>The ClientId parameter when using durable subscriptions</td>
<td>Required if subscriptionDurable is specified as "true"</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>durableSubscriberName</td>
<td>The name of the durable subscriber</td>
<td>Required if subscriptionDurable is specified as "true"</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>retryInterval</td>
<td>The retry interval (in milliseconds) if the JMS connection cannot be established at the beginning or is lost in the middle</td>
<td>no</td>
<td>A valid long value</td>
<td>10000</td>
</tr>
<tr>
<td>maxRetryCount</td>
<td>Maximum retry count if the JMS connection cannot be established at the beginning or is lost in the middle</td>
<td>no</td>
<td>A valid integer value</td>
<td>5</td>
</tr>
<tr>
<td>useReceiver</td>
<td>Use synchronous message receiver to receive message instead of asynchronous message listener</td>
<td>no</td>
<td>true/false</td>
<td>false</td>
</tr>
</tbody>
</table>
<p>Example: </p>
<pre><code>import ballerina.net.jms;

@jms:ConnectionProperty{key:&quot;connectionFactoryType&quot;, value:&quot;queue&quot;}
@jms:ConnectionProperty{key:&quot;destination&quot;, value:&quot;MyQueue&quot;}
@jms:ConnectionProperty{key:&quot;useReceiver&quot;, value:&quot;true&quot;}
@jms:ConnectionProperty{key:&quot;connectionFactoryJNDIName&quot;, value:&quot;QueueConnectionFactory&quot;}
@jms:ConnectionProperty{key:&quot;sessionAcknowledgement&quot;, value:&quot;AUTO_ACKNOWLEDGE&quot;}
</code></pre>

<h3 id="step-3-add-the-resource">Step 3: Add the resource</h3>
<p>Add a resource to the JMS service. This is required, because whenever a message comes from the JMS provider to a specific JMS service, it will be delivered to this particular resource. You must have only one resource in a JMS service.</p>
<p>Example:</p>
<pre><code>import ballerina.net.jms;

@jms:JMSSource {
factoryInitial : &quot;org.wso2.andes.jndi.PropertiesFileInitialContextFactory&quot;,
providerUrl : &quot;/Users/Akalanka/test/jndi.properties&quot;,
connectionFactoryType : &quot;queue&quot;}
@jms:ConnectionProperty{key:&quot;destination&quot;, value:&quot;MyQueue&quot;}
@jms:ConnectionProperty{key:&quot;useReceiver&quot;, value:&quot;true&quot;}
@jms:ConnectionProperty{key:&quot;connectionFactoryJNDIName&quot;, value:&quot;QueueConnectionFactory&quot;}
@jms:ConnectionProperty{key:&quot;sessionAcknowledgement&quot;, value:&quot;AUTO_ACKNOWLEDGE&quot;}
service jmsService {
    resource onMessage (message m) {
        // ProcessMessage
    }
</code></pre>

<p>Now you will have a JMS service that can be deployed to the Ballerina server. </p>
<blockquote>
<p>NOTE: Before deploying the JMS service, you must copy the client-libs provided by the JMS provider to <code>{Ballerina_HOME}/bre/lib</code> </p>
</blockquote>
<p>Following is a sample JMS service.</p>
<pre><code>import ballerina.net.jms;

@jms:JMSSource {
factoryInitial : &quot;org.wso2.andes.jndi.PropertiesFileInitialContextFactory&quot;,
providerUrl : &quot;/Users/Akalanka/test/jndi.properties&quot;}
@jms:ConnectionProperty{key:&quot;connectionFactoryType&quot;, value:&quot;queue&quot;}
@jms:ConnectionProperty{key:&quot;destination&quot;, value:&quot;MyQueue&quot;}
@jms:ConnectionProperty{key:&quot;useReceiver&quot;, value:&quot;true&quot;}
@jms:ConnectionProperty{key:&quot;connectionFactoryJNDIName&quot;, value:&quot;QueueConnectionFactory&quot;}
@jms:ConnectionProperty{key:&quot;sessionAcknowledgement&quot;, value:&quot;AUTO_ACKNOWLEDGE&quot;}
service jmsService {
    resource onMessage (message m) {
        //Process the message
        jms:acknowledge(m, &quot;SUCCESS&quot;);
    }
}
</code></pre>

<h2 id="ballerina-native-functions">Ballerina Native Functions</h2>
<p>This section describes the native functions you can use to work with JMS messages.</p>
<h3 id="package-ballerinalangmessages">Package ballerina.lang.messages</h3>
<p><strong>messages:getHeader</strong></p>
<p>This function can be used to get the value of the particular JMS header. It accepts the following parameters:    </p>
<ul>
<li>Relevant message to get the header from</li>
<li>Header name</li>
</ul>
<p>Example:</p>
<pre><code>import ballerina.lang.messages
---
string jmsMessageId;
jmsMessageId = messages:getHeader(m, &quot;JMS_MESSAGE_ID&quot;);
</code></pre>

<p><strong>messages:getStringPayload</strong></p>
<p>This function can be used to get the string payload of the JMS text message or bytes message. This function accepts the relevant Ballerina message as the parameter. It will return the string payload of the relevant message.</p>
<p>Example:</p>
<pre><code>import ballerina.lang.messages
---
string stringPayload;
stringPayload = messages:getStringPayload(m);
</code></pre>

<p><strong>messages:getStringValue</strong></p>
<p>This function can be used to get the string value of a specific map key in a map type message. This function accepts the following:</p>
<ul>
<li>Relevant Ballerina message to get the string value from</li>
<li>Relevant map key value</li>
</ul>
<p>Example: </p>
<pre><code>import ballerina.lang.messages
---
string stringValue;
stringValue = messages:getStringValue(m, “count”);
</code></pre>

<p><strong>messages:getProperty</strong></p>
<p>This function can be used to retrieve a property from the message.</p>
<p>Example:</p>
<p>Message type can be retrieved from the message as below.</p>
<pre><code>import ballerina.lang.messages;
---

string msgType = messages:getProperty(m, &quot;JMS_MESSAGE_TYPE&quot;);

</code></pre>

<h3 id="package-ballerinanetjms">Package ballerina.net.jms</h3>
<p><strong>jms:acknowledge</strong></p>
<p>This function can be used to acknowledge the message delivery or success, which is particularly useful when using the client acknowledgement mode. This function accepts the following parameters:</p>
<ul>
<li>Ballerina message that needs to be acknowledged </li>
<li>Message delivery status - “SUCCESS” or  “ERROR”</li>
</ul>
<p>Example:</p>
<pre><code>import ballerina.net.jms
---
jms:acknowledge(m, &quot;SUCCESS&quot;);
</code></pre>

<p><strong>jms:commit</strong></p>
<p>This function can be used to commit the JMS session when using the session acknowledgement mode. This function accepts one parameter: the relevant message that the user wants to acknowledge the session with.</p>
<p>Example: </p>
<pre><code>import ballerina.net.jms
---
jms:commit();
</code></pre>

<p><strong>jms:rollback</strong></p>
<p>This function can be used to commit the messages when using the session acknowledgement mode. This function accepts one parameter: the relevant Ballerina message that the user wants to roll back the session with.</p>
<p>Example:</p>
<pre><code>import ballerina.net.jms
---
jms:rollback();
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../websocket-server/" class="btn btn-neutral float-right" title="WebSocket Server Connector">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../jms-client/" class="btn btn-neutral" title="JMS Client Connector"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>2017 WSO2, Inc.</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/ballerinalang/ballerina" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../jms-client/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../websocket-server/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../js/theme.js"></script>

</body>
</html>
